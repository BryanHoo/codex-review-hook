#!/usr/bin/env python3
import json
import sys
from pathlib import Path

# Add project root to sys.path for hooks import
project_root = Path(__file__).resolve().parents[1]
if str(project_root) not in sys.path:
    sys.path.insert(0, str(project_root))

from lib.codexreview_state import update_state_from_post_tool_use

# Read event from stdin
event = json.load(sys.stdin)

# Check for session_id
session_id = event.get("session_id")
if not session_id:
    sys.exit(0)

# Calculate state path
state_path = Path.home() / ".claude" / "state" / "codexreview" / f"{session_id}.json"

# Call update_state_from_post_tool_use
update_state_from_post_tool_use(event, str(state_path))

sys.exit(0)